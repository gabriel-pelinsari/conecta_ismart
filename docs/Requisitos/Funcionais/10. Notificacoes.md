#### RF169 - Notifica√ß√£o de novo coment√°rio em thread que participou

##### User Story
Como **usu√°rio que participou de uma thread**
Quero **receber notifica√ß√£o quando algu√©m comenta em uma thread onde j√° comentei**
Para **acompanhar discuss√£o e n√£o perder respostas relevantes**

##### Descri√ß√£o
Sistema autom√°tico de notifica√ß√µes que envia alerta (in-app + email opcional) quando novo coment√°rio √© adicionado a thread onde usu√°rio participou. Inclui preview do coment√°rio e link direto.

##### Regras de Neg√≥cio
- RN001: Notificar apenas se usu√°rio tem "coment√°rios em threads" ativado nas prefer√™ncias
- RN002: N√£o notificar se pr√≥prio usu√°rio √© quem comentou
- RN003: N√£o notificar coment√°rios removidos por modera√ß√£o
- RN004: M√°ximo 1 notifica√ß√£o por thread por dia (agrupar m√∫ltiplos coment√°rios)
- RN005: Incluir no notification_type para categoriza√ß√£o
- RN006: Armazenar em tabela `notifications` com refer√™ncia ao coment√°rio

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que participei de thread "D√∫vida Python"
      Quando algu√©m comenta nessa thread
      Ent√£o recebo notifica√ß√£o in-app: "Novo coment√°rio em 'D√∫vida Python'"
      
- [ ] Dado que notifica√ß√£o √© enviada
      Quando visualizo
      Ent√£o vejo preview do coment√°rio (primeiras 100 caracteres) + autor
      
- [ ] Dado que clico em notifica√ß√£o
      Quando redirecionado
      Ent√£o acesso thread + novo coment√°rio √© destacado
      
- [ ] Dado que 3 pessoas comentam na thread em 1 hora
      Quando verifico notifica√ß√µes
      Ent√£o vejo 1 notifica√ß√£o agrupada: "3 novos coment√°rios em 'D√∫vida Python'"
      
- [ ] Dado que desabilito "Notifica√ß√µes de coment√°rios" nas prefer√™ncias
      Quando algu√©m comenta
      Ent√£o nenhuma notifica√ß√£o √© enviada
      
- [ ] Dado que notifica√ß√£o √© criada
      Quando verifico banco de dados
      Ent√£o registro cont√©m: user_id, thread_id, comment_id, notification_type, created_at

##### Prioridade
**Alta** - Engajamento essencial

##### Complexidade
**M√©dia** - Trigger com agrega√ß√£o

##### Depend√™ncias
RF027 (Comentar), RF179 (Central de notifica√ß√µes)

##### Notas/Observa√ß√µes
- Trigger: ON INSERT comments THEN enviar notifica√ß√£o a participantes
- Tabela `notifications`: id, user_id, notification_type, related_id, content, is_read, created_at
- Agrega√ß√£o: IF coment√°rio em thread com notifica√ß√£o aberta nas √∫ltimas 24h ENT√ÉO atualizar (count++)
- Email: enviar apenas se prefer√™ncia "Email notifications" est√° ativa
- Delay: enviar notifica√ß√£o com 5-10s de delay (permitir edi√ß√£o r√°pida)
- Exclus√£o: n√£o notificar pr√≥prio criador da thread
- Considerar "Mute thread" para desabilitar notifica√ß√µes de thread espec√≠fica



#### RF170 - Notifica√ß√£o de solicita√ß√£o de amizade recebida

##### User Story
Como **usu√°rio que recebe solicita√ß√£o de amizade**
Quero **ser notificado quando algu√©m envia solicita√ß√£o de amizade**
Para **n√£o perder convites de conectar com outros alunos**

##### Descri√ß√£o
Notifica√ß√£o in-app + email opcional quando solicita√ß√£o de amizade √© recebida. Inclui nome, foto, universidade do solicitante e a√ß√µes r√°pidas (aceitar/recusar).

##### Regras de Neg√≥cio
- RN001: Enviar apenas se prefer√™ncia "Notifica√ß√µes de amizade" est√° ativa
- RN002: N√£o notificar se j√° s√£o amigos
- RN003: N√£o notificar se j√° existe solicita√ß√£o pendente (bidirecional)
- RN004: Incluir a√ß√µes inline: "Aceitar" / "Recusar" (sem abrir outra p√°gina)
- RN005: notification_type: "friend_request_received"
- RN006: Armazenar: user_id, friend_request_id, is_read

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que Jo√£o envia solicita√ß√£o de amizade para Maria
      Quando solicita√ß√£o √© processada
      Ent√£o Maria recebe notifica√ß√£o: "Jo√£o Silva enviou solicita√ß√£o de amizade"
      
- [ ] Dado que notifica√ß√£o √© exibida
      Quando visualizo
      Ent√£o vejo: foto de Jo√£o, nome, universidade + bot√µes "Aceitar" e "Recusar"
      
- [ ] Dado que clico em "Aceitar" na notifica√ß√£o
      Quando a√ß√£o processa
      Ent√£o amizade √© confirmada sem recarregar p√°gina
      
- [ ] Dado que clico em "Recusar"
      Quando confirmo
      Ent√£o solicita√ß√£o √© rejeitada e notifica√ß√£o desaparece
      
- [ ] Dado que desabilito notifica√ß√µes de amizade
      Quando recebo nova solicita√ß√£o
      Ent√£o nenhuma notifica√ß√£o √© enviada
      
- [ ] Dado que verifico hist√≥rico de notifica√ß√µes
      Quando acesso Central de Notifica√ß√µes
      Ent√£o vejo todas solicita√ß√µes recebidas

##### Prioridade
**Alta** - Conex√£o de usu√°rios

##### Complexidade
**M√©dia** - Notifica√ß√£o com a√ß√µes inline

##### Depend√™ncias
RF057 (Enviar solicita√ß√£o de amizade)

##### Notas/Observa√ß√µes
- Trigger: ON INSERT friend_requests THEN enviar notifica√ß√£o
- Valida√ß√£o: verificar status existing (n√£o duplicar se pendente)
- A√ß√µes inline: AJAX calls para aceitar/recusar sem redire√ß√£o
- Foto/avatar: incluir thumbnail 48x48px na notifica√ß√£o
- Email template: personalizado com foto e bot√£o de a√ß√£o
- Dismiss: usu√°rio pode fechar notifica√ß√£o sem aceitar/recusar
- Considerar "Auto-decline ap√≥s 7 dias" (Fase 2)



#### RF171 - Notifica√ß√£o de amizade aceita

##### User Story
Como **usu√°rio que enviou solicita√ß√£o de amizade**
Quero **ser notificado quando minha solicita√ß√£o √© aceita**
Para **saber que consigo conectar com novo aluno e visualizar contatos liberados**

##### Descri√ß√£o
Notifica√ß√£o in-app + email opcional informando que solicita√ß√£o de amizade foi aceita. Inclui nome do novo amigo, foto e a√ß√£o r√°pida "Ver contatos" ou "Iniciar conversa".

##### Regras de Neg√≥cio
- RN001: Enviar apenas se prefer√™ncia "Notifica√ß√µes de amizade" ativa
- RN002: notification_type: "friend_request_accepted"
- RN003: Incluir foto, nome, universidade do novo amigo
- RN004: A√ß√µes: "Ver Perfil" ou "Ver Contatos" (se contatos liberados)
- RN005: Armazenar: user_id, friend_id, is_read, created_at

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que Maria aceita solicita√ß√£o de Jo√£o
      Quando a√ß√£o processa
      Ent√£o Jo√£o recebe notifica√ß√£o: "Maria Silva aceitou sua solicita√ß√£o de amizade"
      
- [ ] Dado que notifica√ß√£o √© exibida
      Quando visualizo
      Ent√£o vejo foto de Maria + nome + universidade + bot√£o "Ver Perfil"
      
- [ ] Dado que clico em "Ver Perfil"
      Quando a√ß√£o executa
      Ent√£o redirecionado para perfil de Maria
      
- [ ] Dado que contatos foram liberados
      Quando visualizo notifica√ß√£o
      Ent√£o vejo bot√£o adicional "Ver Contatos" (WhatsApp, Instagram, LinkedIn)
      
- [ ] Dado que verifico notifica√ß√µes
      Quando acesso Central
      Ent√£o vejo hist√≥rico de todas amizades aceitas

##### Prioridade
**Alta** - Confirma√ß√£o de conex√£o

##### Complexidade
**Baixa** - Notifica√ß√£o simples

##### Depend√™ncias
RF060 (Aceitar solicita√ß√£o de amizade), RF171 (Liberar contatos)

##### Notas/Observa√ß√µes
- Trigger: ON UPDATE friend_requests SET status='accepted'
- Email: template celebrando nova amizade
- Contatos liberados: buscar dados de RF067 (liberar contatos)
- Foto: thumbnail 48x48px com border circular
- CTA forte: bot√£o prim√°rio "Ver Perfil"



#### RF172 - Notifica√ß√£o de novo mentorado (para mentores)

##### User Story
Como **mentor na plataforma**
Quero **ser notificado quando um aluno √© atribu√≠do como mentorado**
Para **acompanhar novos mentorados e preparar pr√≥ximas sess√µes**

##### Descri√ß√£o
Notifica√ß√£o in-app + email informando mentor sobre novo mentorado atribu√≠do. Inclui nome, universidade, curso do mentorado e √°rea de mentoria. Oferece a√ß√£o r√°pida "Ver Perfil" ou "Agendar Sess√£o".

##### Regras de Neg√≥cio
- RN001: Enviar apenas se prefer√™ncia "Notifica√ß√µes de mentoria" ativa
- RN002: notification_type: "new_mentee_assigned"
- RN003: Incluir: nome mentorado, universidade, curso, √°rea mentoria
- RN004: A√ß√µes: "Ver Perfil Mentorado" e "Agendar Primeira Sess√£o"
- RN005: Armazenar: mentor_id, mentorship_id, mentee_id, is_read

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que sistema atribui novo mentorado para Jo√£o (mentor)
      Quando atribui√ß√£o processa
      Ent√£o Jo√£o recebe notifica√ß√£o: "Novo mentorado atribu√≠do: Maria Silva"
      
- [ ] Dado que notifica√ß√£o √© exibida
      Quando visualizo
      Ent√£o vejo: nome, universidade, curso, √°rea mentoria + foto
      
- [ ] Dado que clico em "Ver Perfil Mentorado"
      Quando a√ß√£o executa
      Ent√£o acesso perfil completo de Maria
      
- [ ] Dado que clico em "Agendar Primeira Sess√£o"
      Quando modal abre
      Ent√£o vejo calend√°rio para escolher data/hora
      
- [ ] Dado que desabilito notifica√ß√µes de mentoria
      Quando novo mentorado √© atribu√≠do
      Ent√£o nenhuma notifica√ß√£o √© enviada

##### Prioridade
**M√©dia** - Programa de mentoria

##### Complexidade
**Baixa** - Notifica√ß√£o com a√ß√µes

##### Depend√™ncias
RF (Sistema de mentoria)

##### Notas/Observa√ß√µes
- Trigger: ON INSERT mentorships
- Email: template apresentando mentorado
- Foto: avatar do mentorado em 48x48px
- Calend√°rio: integra√ß√£o com RF (agendamento de sess√µes)
- Considerar "Lembrete 24h antes primeira sess√£o"



#### RF173 - Notifica√ß√£o de mentor atribu√≠do (para mentorados)

##### User Story
Como **mentorado que recebi um mentor**
Quero **ser notificado quando um mentor √© atribu√≠do para me ajudar**
Para **saber com quem estarei trabalhando e preparar primeira sess√£o**

##### Descri√ß√£o
Notifica√ß√£o in-app + email informando mentorado sobre mentor atribu√≠do. Inclui nome, especialidade, universidade do mentor e contatos (se liberados). Oferece a√ß√µes "Ver Perfil" ou "Enviar Mensagem".

##### Regras de Neg√≥cio
- RN001: Enviar apenas se prefer√™ncia "Notifica√ß√µes de mentoria" ativa
- RN002: notification_type: "mentor_assigned"
- RN003: Incluir: nome mentor, especialidade, universidade
- RN004: Se contatos liberados: mostrar WhatsApp/Email do mentor
- RN005: A√ß√µes: "Ver Perfil Mentor" e "Enviar Mensagem" (se chat existir)
- RN006: Armazenar: mentee_id, mentorship_id, mentor_id, is_read

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que sistema atribui mentor para Maria (mentorada)
      Quando atribui√ß√£o processa
      Ent√£o Maria recebe notifica√ß√£o: "Seu mentor foi atribu√≠do: Jo√£o Silva"
      
- [ ] Dado que notifica√ß√£o √© exibida
      Quando visualizo
      Ent√£o vejo: nome mentor, especialidade (ex: Python/Web), universidade
      
- [ ] Dado que contatos do mentor foram liberados
      Quando visualizo notifica√ß√£o
      Ent√£o vejo WhatsApp e Email para contato direto
      
- [ ] Dado que clico em "Ver Perfil Mentor"
      Quando a√ß√£o executa
      Ent√£o acesso perfil completo de Jo√£o
      
- [ ] Dado que clico em "Enviar Mensagem"
      Quando chat abre
      Ent√£o posso enviar mensagem inicial para mentor

##### Prioridade
**M√©dia** - Programa de mentoria

##### Complexidade
**Baixa** - Notifica√ß√£o com a√ß√µes

##### Depend√™ncias
RF (Sistema de mentoria e chat)

##### Notas/Observa√ß√µes
- Trigger: ON INSERT mentorships THEN enviar para mentorado
- Email: apresenta√ß√£o do mentor com foto
- Contatos: buscar de RF067 (contatos liberados)
- Chat: integra√ß√£o com sistema de mensageria
- Foto: avatar do mentor em 48x48px



#### RF174 - Notifica√ß√£o de evento pr√≥ximo (24h antes)

##### User Story
Como **usu√°rio inscrito em evento**
Quero **receber lembrete 24 horas antes do evento come√ßar**
Para **n√£o esquecer e garantir presen√ßa**

##### Descri√ß√£o
Notifica√ß√£o autom√°tica acionada 24 horas antes de evento come√ßar. Inclui nome do evento, data/hora, local e bot√£o "Confirmar Presen√ßa" ou "Ver Detalhes". Pode ser enviada via email + in-app.

##### Regras de Neg√≥cio
- RN001: Enviar apenas se prefer√™ncia "Lembrete de eventos" ativa
- RN002: Enviar automaticamente 24 horas antes (job agendado)
- RN003: Apenas para usu√°rios com status "registered" ou "confirmed"
- RN004: notification_type: "event_reminder_24h"
- RN005: N√£o enviar se evento foi cancelado
- RN006: Incluir link direto para detalhe do evento
- RN007: Armazenar: user_id, event_id, notification_type, is_read

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que me inscrevi em evento "Workshop Python" em 20/10 √†s 14:00
      Quando chega 19/10 √†s 14:00 (24h antes)
      Ent√£o recebo notifica√ß√£o: "Lembrete: Workshop Python amanh√£ √†s 14:00"
      
- [ ] Dado que notifica√ß√£o √© enviada
      Quando visualizo
      Ent√£o vejo: t√≠tulo, data/hora, local + bot√£o "Ver Detalhes"
      
- [ ] Dado que clico em notifica√ß√£o
      Quando a√ß√£o executa
      Ent√£o acesso p√°gina de detalhe do evento
      
- [ ] Dado que desabilito "Lembrete de eventos"
      Quando 24h antes
      Ent√£o nenhuma notifica√ß√£o √© enviada
      
- [ ] Dado que evento foi cancelado
      Quando 24h antes (se still within window)
      Ent√£o notifica√ß√£o n√£o √© enviada

##### Prioridade
**Alta** - Reduzir faltas

##### Complexidade
**M√©dia** - Job scheduler + query

##### Depend√™ncias
RF145 (Eventos criados), RF (Inscri√ß√£o em eventos)

##### Notas/Observa√ß√µes
- Job scheduler: executar diariamente (06:00) verificando eventos com start_date = NOW() + 24h
- Query: SELECT * FROM event_registrations WHERE event_id IN (SELECT id FROM events WHERE start_date = DATE_ADD(NOW(), INTERVAL 24 HOUR))
- Email: template com detalhes do evento + mapa (se tiver local)
- Confirma√ß√£o: allow "Confirmar Presen√ßa" na notifica√ß√£o sem abrir evento
- Considerar "Lembrete 1 hora antes" (Fase 2)



#### RF175 - Notifica√ß√£o de cancelamento de evento

##### User Story
Como **usu√°rio inscrito em evento que foi cancelado**
Quero **ser imediatamente notificado do cancelamento**
Para **n√£o ir at√© o local e reorganizar meu tempo**

##### Descri√ß√£o
Notifica√ß√£o urgente (in-app + email) enviada imediatamente quando evento √© cancelado. Inclui motivo do cancelamento, data/hora original e op√ß√£o de reembolso (se aplic√°vel).

##### Regras de Neg√≥cio
- RN001: Enviar para TODOS inscritos no evento (status registered/confirmed/attended)
- RN002: notification_type: "event_cancelled"
- RN003: Prioridade alta (alert/urgent)
- RN004: Incluir motivo do cancelamento
- RN005: Se evento era pago: informar sobre reembolso/cr√©dito
- RN006: Incluir email do organizador para d√∫vidas
- RN007: Enviar imediatamente (n√£o aguardar job agendado)

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que evento "Python Workshop" √© cancelado por admin
      Quando cancelamento processa
      Ent√£o todos inscritos recebem notifica√ß√£o: "Evento cancelado: Python Workshop"
      
- [ ] Dado que notifica√ß√£o √© exibida
      Quando visualizo
      Ent√£o vejo: motivo cancelamento, data/hora original + email organizador
      
- [ ] Dado que evento era pago
      Quando recebo notifica√ß√£o
      Ent√£o vejo: "Seu pagamento ser√° reembolsado em at√© 3 dias √∫teis"
      
- [ ] Dado que clico em "Contatar Organizador"
      Quando a√ß√£o executa
      Ent√£o abro email pr√©-preenchido para organizador
      
- [ ] Dado que verifico notifica√ß√µes
      Quando acesso Central
      Ent√£o vejo notifica√ß√£o de cancelamento

##### Prioridade
**Alta** - Informa√ß√£o cr√≠tica

##### Complexidade
**M√©dia** - Batch notification com email

##### Depend√™ncias
RF161 (Cancelar eventos), RF (Inscri√ß√£o em eventos)

##### Notas/Observa√ß√µes
- Trigger: ON UPDATE events SET status='cancelled'
- Query: SELECT user_id FROM event_registrations WHERE event_id=?
- Email: template urgente com destaque em vermelho
- Tipo: "alert" (n√£o agrup√°vel, sempre mostra)
- Reembolso: buscar l√≥gica de pagamentos
- Considerar "SMS" para eventos cr√≠ticos (Fase 2)



#### RF176 - Notifica√ß√£o de conquista de badge

##### User Story
Como **usu√°rio que conquistou uma badge**
Quero **ser notificado quando ganho uma badge**
Para **celebrar conquista e ser motivado a continuar engajado**

##### Descri√ß√£o
Notifica√ß√£o celebrat√≥ria in-app + email quando usu√°rio conquista badge (autom√°tica ou atribu√≠da manualmente). Inclui nome da badge, √≠cone, descri√ß√£o e op√ß√£o de compartilhar em redes sociais.

##### Regras de Neg√≥cio
- RN001: Enviar automaticamente quando badge √© conquistada
- RN002: notification_type: "badge_achieved"
- RN003: Prioridade: normal
- RN004: Incluir √≠cone, nome, descri√ß√£o da badge
- RN005: A√ß√£o: "Ver Badge" e "Compartilhar" (redes sociais)
- RN006: Armazenar: user_id, badge_id, is_read, created_at
- RN007: N√£o enviar email por padr√£o (apenas in-app), mas permitir op√ß√£o

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que usu√°rio conquista badge "Python Expert"
      Quando crit√©rio √© atingido
      Ent√£o recebe notifica√ß√£o: "üèÜ Parab√©ns! Voc√™ conquistou a badge 'Python Expert'"
      
- [ ] Dado que notifica√ß√£o √© exibida
      Quando visualizo
      Ent√£o vejo: √≠cone, nome, descri√ß√£o + "Compartilhar"
      
- [ ] Dado que clico em "Compartilhar"
      Quando menu abre
      Ent√£o vejo op√ß√µes: LinkedIn, Twitter, Copiar link
      
- [ ] Dado que clico em "Ver Badge"
      Quando a√ß√£o executa
      Ent√£o acesso perfil com todas badges conquistadas
      
- [ ] Dado que notifica√ß√£o √© criada
      Quando verifico banco
      Ent√£o registro cont√©m badge_id + refer√™ncia correta

##### Prioridade
**Alta** - Gamifica√ß√£o e motiva√ß√£o

##### Complexidade
**Baixa** - Notifica√ß√£o simples com a√ß√µes

##### Depend√™ncias
RF151 (Criar badge), RF156 (Atribuir badge)

##### Notas/Observa√ß√µes
- Trigger: ON INSERT user_badges
- Email: template celebrativo com GIF animado (opcional)
- Compartilhamento: pre-fill texto "Acabei de conquistar a badge Python Expert em [plataforma]"
- Som: som de celebra√ß√£o ao exibir notifica√ß√£o (se som ativado nas prefer√™ncias)
- Considerar "Rarity animation" para badges raras (efeito visual especial)



#### RF177 - Notifica√ß√£o de upvote em thread/coment√°rio pr√≥prio

##### User Story
Como **autor de thread ou coment√°rio**
Quero **ser notificado quando algu√©m d√° upvote no meu conte√∫do**
Para **saber que meu conte√∫do √© √∫til e me motivar a continuar contribuindo**

##### Descri√ß√£o
Notifica√ß√£o in-app (sem email por padr√£o) quando usu√°rio recebe upvotes em thread ou coment√°rio. Inclui contador de upvotes, preview do conte√∫do e link direto. Agrupa m√∫ltiplos upvotes do mesmo conte√∫do.

##### Regras de Neg√≥cio
- RN001: Enviar apenas se prefer√™ncia "Notifica√ß√µes de upvote" ativa
- RN002: N√£o notificar upvote pr√≥prio (n√£o poss√≠vel)
- RN003: Agregar: m√°ximo 1 notifica√ß√£o por conte√∫do por dia
- RN004: notification_type: "upvote_received"
- RN005: Incluir: contador de upvotes, preview (50 caracteres), link
- RN006: Apenas in-app (n√£o email, exceto se configurado)
- RN007: Armazenar: user_id, thread_id OR comment_id, upvote_count, is_read

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que meu coment√°rio recebe upvote
      Quando upvote √© registrado
      Ent√£o recebo notifica√ß√£o: "üëç Seu coment√°rio recebeu um upvote"
      
- [ ] Dado que recebo 5 upvotes no mesmo coment√°rio em 1 hora
      Quando visualizo notifica√ß√µes
      Ent√£o vejo 1 notifica√ß√£o: "üëç Seu coment√°rio recebeu 5 upvotes"
      
- [ ] Dado que notifica√ß√£o √© exibida
      Quando visualizo
      Ent√£o vejo preview do conte√∫do + contador "5 üëç"
      
- [ ] Dado que clico em notifica√ß√£o
      Quando redirecionado
      Ent√£o acesso thread/coment√°rio com upvotes destacados
      
- [ ] Dado que desabilito notifica√ß√µes de upvote
      Quando recebo novo upvote
      Ent√£o nenhuma notifica√ß√£o √© enviada

##### Prioridade
**M√©dia** - Motiva√ß√£o de engajamento

##### Complexidade
**M√©dia** - Agrega√ß√£o com l√≥gica de batch

##### Depend√™ncias
RF030 (Upvote em threads), RF032 (Upvote em coment√°rios)

##### Notas/Observa√ß√µes
- Trigger: ON INSERT votes (vote_type='up')
- Agrega√ß√£o: IF notifica√ß√£o aberta para mesmo conte√∫do (√∫ltimas 24h) THEN atualizar count
- Email: desabilitar por padr√£o, permitir opt-in nas prefer√™ncias
- Preview: primeiros 50 caracteres do conte√∫do
- Link direto: ir para thread + destacar coment√°rio/thread votada
- Considerar "Top coment√°rios" notifica√ß√£o quando atinge X upvotes (Fase 2)



#### RF178 - Notifica√ß√£o de men√ß√£o em coment√°rio

##### User Story
Como **usu√°rio mencionado em coment√°rio**
Quero **ser notificado quando algu√©m me menciona (usando @)**
Para **participar da conversa e responder men√ß√µes relevantes**

##### Descri√ß√£o
Notifica√ß√£o in-app + email opcional quando usu√°rio √© mencionado usando @ em coment√°rio. Inclui nome do mencionador, thread, preview do coment√°rio e a√ß√£o "Responder Men√ß√£o".

##### Regras de Neg√≥cio
- RN001: Enviar quando formato @username √© detectado no coment√°rio
- RN002: Apenas 1 notifica√ß√£o por men√ß√£o (n√£o duplicar)
- RN003: notification_type: "mention_in_comment"
- RN004: Incluir: nome mencionador, thread, preview coment√°rio
- RN005: A√ß√£o: "Ver Men√ß√£o" (link direto)
- RN006: Email opcional (prefer√™ncia do usu√°rio)
- RN007: N√£o notificar auto-mentions (usu√°rio mencionando a si mesmo)

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que Jo√£o comenta em thread e escreve "@Maria d√∫vida importante"
      Quando coment√°rio √© publicado
      Ent√£o Maria recebe notifica√ß√£o: "Jo√£o te mencionou em 'D√∫vida Python'"
      
- [ ] Dado que notifica√ß√£o √© exibida
      Quando visualizo
      Ent√£o vejo: nome, thread, preview coment√°rio com @Maria destacado
      
- [ ] Dado que clico em notifica√ß√£o
      Quando redirecionado
      Ent√£o acesso thread + coment√°rio com men√ß√£o √© destacado
      
- [ ] Dado que Jo√£o menciona "@Maria @Pedro"
      Quando coment√°rio √© publicado
      Ent√£o Maria E Pedro recebem notifica√ß√µes separadas
      
- [ ] Dado que desabilito notifica√ß√µes de men√ß√£o
      Quando sou mencionado
      Ent√£o nenhuma notifica√ß√£o √© enviada

##### Prioridade
**Alta** - Engajamento direto

##### Complexidade
**M√©dia** - Parse de mentions + notifica√ß√µes batch

##### Depend√™ncias
RF027 (Comentar)

##### Notas/Observa√ß√µes
- Detec√ß√£o: regex @(\w+) para extrair usernames
- Valida√ß√£o: verificar se username existe antes de notificar
- Email: template com contexto completo (thread + coment√°rio)
- Link: ir direto para coment√°rio mencionado
- Highlight: coment√°rio com mention destacado em cor diferente
- Limitar: m√°ximo 10 mentions por coment√°rio (spam prevention)
- Considerar "@ everyone" para moderadores (Fase 2)



#### RF179 - Central de notifica√ß√µes

##### User Story
Como **usu√°rio**
Quero **visualizar todas as minhas notifica√ß√µes em um √∫nico lugar**
Para **acompanhar tudo o que recebi sem perder informa√ß√µes**

##### Descri√ß√£o
Hub centralizado mostrando todas notifica√ß√µes com filtros por tipo, per√≠odo e status. Ordena√ß√£o por rec√™ncia, a√ß√µes em massa (marcar como lida), e sincroniza√ß√£o em tempo real com badge de contagem.

##### Regras de Neg√≥cio
- RN001: Exibir todas notifica√ß√µes do usu√°rio logado (hist√°tico)
- RN002: Ordena√ß√£o padr√£o: mais recentes primeiro
- RN003: Filtros: por tipo (coment√°rios, amizade, eventos, badges, men√ß√µes)
- RN004: Filtro: lidas/n√£o-lidas
- RN005: Pagina√ß√£o: 20 notifica√ß√µes por p√°gina
- RN006: Badge de contagem: mostrar # de n√£o-lidas no √≠cone
- RN007: Sincroniza√ß√£o real-time: novo notifica√ß√µes aparecem sem refresh
- RN008: Search: permitir busca por palavra-chave

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que acesso "Centro de Notifica√ß√µes"
      Quando carrega
      Ent√£o vejo lista com TODAS notifica√ß√µes ordenadas por data (recentes primeiro)
      
- [ ] Dado que tenho 25 notifica√ß√µes n√£o-lidas
      Quando visualizo icon de notifica√ß√£o
      Ent√£o vejo badge com "25" em vermelho
      
- [ ] Dado que filtro por "Coment√°rios"
      Quando aplico
      Ent√£o vejo apenas notifica√ß√µes de tipo coment√°rio
      
- [ ] Dado que filtro por "N√£o lidas"
      Quando aplico
      Ent√£o vejo apenas notifica√ß√µes n√£o marcadas como lidas
      
- [ ] Dado que nova notifica√ß√£o chega
      Quando sistema sincroniza
      Ent√£o notifica√ß√£o aparece no topo em tempo real (sem refresh)
      
- [ ] Dado que clico em notifica√ß√£o
      Quando a√ß√£o executa
      Ent√£o redirecionado para contexto relevante

##### Prioridade
**Alta** - Hub essencial

##### Complexidade
**M√©dia** - Query com filtros + real-time sync

##### Depend√™ncias
RF169-RF178 (Todas notifica√ß√µes)

##### Notas/Observa√ß√µes
- Tabela `notifications`: id, user_id, notification_type, related_id, content, is_read, created_at
- Query: SELECT * FROM notifications WHERE user_id=? ORDER BY created_at DESC LIMIT 20 OFFSET ?
- Filtros: WHERE notification_type IN (?) OR is_read=?
- Real-time: WebSocket para novos eventos (SSE como fallback)
- Badge: SELECT COUNT(*) FROM notifications WHERE user_id=? AND is_read=0
- Busca full-text: MATCH(content) AGAINST(?)
- Pagina√ß√£o: cursor-based com created_at
- Considerar "Starred" notifica√ß√µes (Fase 2)



#### RF180 - Marcar notifica√ß√£o como lida

##### User Story
Como **usu√°rio**
Quero **marcar notifica√ß√µes como lidas quando leio**
Para **diferenciar o que j√° vi do que ainda preciso acompanhar**

##### Descri√ß√£o
A√ß√£o que marca notifica√ß√£o individual como lida, removendo do contador de n√£o-lidas e atualizando visual (remove highlight/√≠cone de n√£o-lida).

##### Regras de Neg√≥cio
- RN001: Clicar em notifica√ß√£o marca automaticamente como lida
- RN002: Bot√£o manual "Marcar como lida" dispon√≠vel na Central
- RN003: Update: is_read=1, read_at=NOW()
- RN004: Badge de contagem atualiza em tempo real
- RN005: Notifica√ß√£o j√° lida n√£o pode ser marcada como n√£o-lida novamente
- RN006: Revers√≠vel: pode "Marcar como n√£o-lida" (Fase 2)

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que visualizo notifica√ß√£o n√£o-lida (com highlight)
      Quando clico em notifica√ß√£o
      Ent√£o √© marcada como lida automaticamente
      
- [ ] Dado que notifica√ß√£o √© marcada como lida
      Quando verifico Centro de Notifica√ß√µes
      Ent√£o highlight desaparece e n√£o conta no badge
      
- [ ] Dado que visualizo notifica√ß√£o lida
      Quando clico em "Marcar como lida" (bot√£o)
      Ent√£o a√ß√£o n√£o faz nada (j√° est√° lida)
      
- [ ] Dado que tinha 5 n√£o-lidas
      Quando marco 1 como lida
      Ent√£o badge atualiza para "4" em tempo real
      
- [ ] Dado que clico em notifica√ß√£o
      Quando a√ß√£o processa
      Ent√£o √©_read=1 e read_at √© registrado no BD

##### Prioridade
**Alta** - Intera√ß√£o essencial

##### Complexidade
**Baixa** - Update simples

##### Depend√™ncias
RF179 (Central de notifica√ß√µes)

##### Notas/Observa√ß√µes
- Query: UPDATE notifications SET is_read=1, read_at=NOW() WHERE id=? AND user_id=?
- Auto-mark: ao redirecionar para contexto, marcar notifica√ß√£o como lida
- Visual: CSS class "not-read" removed quando lida
- Badge: atualizar em tempo real (WebSocket ou AJAX)
- Timestamp: read_at importante para analytics (tempo at√© leitura)



#### RF181 - Marcar todas como lidas

##### User Story
Como **usu√°rio com muitas notifica√ß√µes n√£o-lidas**
Quero **marcar todas as notifica√ß√µes como lidas de uma vez**
Para **limpar o inbox r√°pido e come√ßar do zero**

##### Descri√ß√£o
A√ß√£o em massa que marca todas notifica√ß√µes do usu√°rio como lidas em um clique. Inclui confirma√ß√£o opcional e atualiza√ß√£o instant√¢nea do badge e visual.

##### Regras de Neg√≥cio
- RN001: A√ß√£o "Marcar Todas como Lidas" vis√≠vel apenas se h√° n√£o-lidas
- RN002: Requer confirma√ß√£o (opcional: "Tem certeza?")
- RN003: Update batch: UPDATE notifications SET is_read=1 WHERE user_id=?
- RN004: Badge atualiza para 0 imediatamente
- RN005: Todas notifica√ß√µes na Central perdem highlight
- RN006: Opera√ß√£o revers√≠vel em Fase 2

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que tenho 42 notifica√ß√µes n√£o-lidas
      Quando visualizo Centro de Notifica√ß√µes
      Ent√£o vejo bot√£o "Marcar Todas como Lidas"
      
- [ ] Dado que clico em "Marcar Todas como Lidas"
      Quando confirmo
      Ent√£o todas notifica√ß√µes s√£o marcadas como lidas instantaneamente
      
- [ ] Dado que a√ß√£o processa
      Quando visualizo
      Ent√£o badge muda para "0" e todos highlights desaparecem
      
- [ ] Dado que j√° marquei todas como lidas
      Quando recebo nova notifica√ß√£o
      Ent√£o bot√£o reaparece (se nova n√£o-lida existe)
      
- [ ] Dado que clico em "Marcar Todas"
      Quando confirmo
      Ent√£o BD processa: UPDATE ... is_read=1 WHERE user_id=?

##### Prioridade
**M√©dia** - Conveni√™ncia

##### Complexidade
**Baixa** - Batch update

##### Depend√™ncias
RF179 (Central de notifica√ß√µes), RF180 (Marcar individual)

##### Notas/Observa√ß√µes
- Query: UPDATE notifications SET is_read=1, read_at=NOW() WHERE user_id=? AND is_read=0
- Confirma√ß√£o: modal simples com "Tem certeza? Todas ser√£o marcadas"
- Performance: usar batch update (n√£o loop individual)
- Bot√£o: desabilitado se 0 n√£o-lidas
- Visual: transi√ß√£o suave quando highlights removidos
- Logging: registrar a√ß√£o para analytics



#### RF182 - Configura√ß√µes de notifica√ß√µes (ativar/desativar por tipo)

##### User Story
Como **usu√°rio**
Quero **configurar quais tipos de notifica√ß√µes recebo**
Para **personalizar minha experi√™ncia e n√£o ser incomodado com alertas irrelevantes**

##### Descri√ß√£o
Painel de prefer√™ncias permitindo ativar/desativar cada tipo de notifica√ß√£o (coment√°rios, amizade, eventos, badges, menc√ß√µes, etc). Inclui op√ß√µes de canal (in-app, email, SMS) e frequ√™ncia de entrega.

##### Regras de Neg√≥cio
- RN001: Todas notifica√ß√µes ativadas por padr√£o (opt-out)
- RN002: Tipos configur√°veis: coment√°rios, amizade, eventos, badges, men√ß√µes, mentorias
- RN003: Canais: in-app (sempre), email (opt-in), SMS (opt-in futura)
- RN004: Frequ√™ncia: instant√¢nea, resumida (di√°ria), desabilitada
- RN005: Armazenar prefer√™ncias em tabela `user_notification_preferences`
- RN006: Altera√ß√µes s√£o imediatas (sem confirma√ß√£o)
- RN007: Toggle switches com labels claros

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que acesso "Configura√ß√µes de Notifica√ß√µes"
      Quando carrega
      Ent√£o vejo lista com todos tipos de notifica√ß√µes
      
- [ ] Dado que tipos s√£o listados
      Quando visualizo
      Ent√£o vejo: coment√°rios, amizade, eventos, badges, men√ß√µes, mentorias (com toggle)
      
- [ ] Dado que desabilito "Notifica√ß√µes de Coment√°rios"
      Quando salvo
      Ent√£o nenhuma notifica√ß√£o de coment√°rio √© enviada daqui em diante
      
- [ ] Dado que habilito "Email para Eventos"
      Quando salvo
      Ent√£o notifica√ß√µes de evento s√£o enviadas tamb√©m por email
      
- [ ] Dado que defino frequ√™ncia "Resumida" para Badges
      Quando sistema processa
      Ent√£o badges conquistadas s√£o agrupadas e enviadas diariamente
      
- [ ] Dado que retorno √†s configura√ß√µes
      Quando visualizo
      Ent√£o prefer√™ncias salvas est√£o selecionadas (estado persistido)

##### Prioridade
**Alta** - Controle do usu√°rio

##### Complexidade
**M√©dia** - CRUD de prefer√™ncias com m√∫ltiplas op√ß√µes

##### Depend√™ncias
RF169-RF178 (Todas notifica√ß√µes)

##### Notas/Observa√ß√µes
- Tabela `user_notification_preferences`: user_id, notification_type, enabled, channel (in_app/email/sms), frequency, updated_at
- Tipos: comment_new, friend_request_received, friend_request_accepted, new_mentee, mentor_assigned, event_reminder, event_cancelled, badge_achieved, upvote_received, mention_in_comment
- Canais padr√£o: in_app=sempre, email=opt-in, sms=future
- Frequ√™ncia: instant, daily_digest, disabled
- Valida√ß√£o: verificar prefer√™ncia antes de enviar qualquer notifica√ß√£o
- UI: toggle switches com descriptions claras (ex: "Ser notificado quando algu√©m comentar em minha thread")
- Considerar "Quiet hours" (Fase 2) para n√£o receber notifica√ß√µes entre X e Y horas



#### RF183 - Denunciar thread inadequada

##### User Story
Como **usu√°rio**
Quero **denunciar threads que violam diretrizes ou s√£o inadequadas**
Para **ajudar moderadores a manter qualidade do f√≥rum**

##### Descri√ß√£o
Funcionalidade permitindo usu√°rios denunciar thread problem√°tica. Abre modal com sele√ß√£o de motivo, descri√ß√£o opcional e confirma√ß√£o. Den√∫ncia √© armazenada para moderadores processarem.

##### Regras de Neg√≥cio
- RN001: Apenas usu√°rios autenticados podem denunciar
- RN002: Den√∫ncia inclui: thread_id, user_id (denunciante), motivo, descri√ß√£o, timestamp
- RN003: N√£o permitir den√∫ncia de thread pr√≥pria (valida√ß√£o)
- RN004: Den√∫ncia √© an√¥nima para autor da thread
- RN005: Armazenar em tabela `reports` com status "pending"
- RN006: Confirma√ß√£o visual: "Den√∫ncia enviada com sucesso"
- RN007: Notifica√ß√£o ao moderador ap√≥s envio

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que visualizo thread
      Quando clico em menu "..."
      Ent√£o vejo op√ß√£o "Denunciar"
      
- [ ] Dado que clico em "Denunciar"
      Quando modal abre
      Ent√£o vejo: t√≠tulo da thread, seletor de motivo, campo de descri√ß√£o opcional
      
- [ ] Dado que sou autor da thread
      Quando acesso a√ß√µes
      Ent√£o op√ß√£o "Denunciar" n√£o aparece (desabilitada)
      
- [ ] Dado que seleciono motivo "Spam"
      Quando confirmo
      Ent√£o den√∫ncia √© enviada + modal fecha com mensagem "Obrigado!"
      
- [ ] Dado que den√∫ncia √© enviada
      Quando verifico banco de dados
      Ent√£o registro em `reports` com: thread_id, user_id, motivo, created_at, status='pending'
      
- [ ] Dado que clico em "Denunciar"
      Quando a√ß√£o completa
      Ent√£o moderador recebe notifica√ß√£o (ou alerta em painel)

##### Prioridade
**Alta** - Controle de qualidade comunit√°rio

##### Complexidade
**M√©dia** - Modal com valida√ß√£o + notifica√ß√£o

##### Depend√™ncias
RF022 (Criar thread), RF129 (Fila de den√∫ncias)

##### Notas/Observa√ß√µes
- Tabela `reports`: id, reported_type (thread/comment/user), reported_id, reporter_id, reason, description, status, created_at, handled_by, handled_at
- Valida√ß√£o: WHERE reporter_id != thread_creator_id
- Modal: form com dropdown motivo + textarea para descri√ß√£o (max 500 caracteres)
- Confirma√ß√£o: toast/snackbar "Den√∫ncia enviada. Obrigado por ajudar!"
- Notifica√ß√£o moderador: usar RF169+ para alertar painel
- Auditoria: registrar IP/user-agent para detec√ß√£o de abuso
- Considerar "Den√∫ncias em massa" detection (Fase 2)



#### RF184 - Denunciar coment√°rio inadequado

##### User Story
Como **usu√°rio**
Quero **denunciar coment√°rios que violam diretrizes**
Para **sinalizar conte√∫do problem√°tico rapidamente**

##### Descri√ß√£o
Funcionalidade permitindo denunciar coment√°rio espec√≠fico dentro de thread. Inclui sele√ß√£o de motivo e descri√ß√£o opcional. Den√∫ncia √© processada por moderadores com prioridade.

##### Regras de Neg√≥cio
- RN001: Apenas usu√°rios autenticados podem denunciar
- RN002: Den√∫ncia n√£o permite ser do pr√≥prio autor (valida√ß√£o)
- RN003: Armazenar: comment_id, reporter_id, motivo, descri√ß√£o, thread_id (contexto)
- RN004: Status inicial: "pending"
- RN005: An√¥nimo para autor do coment√°rio
- RN006: Confirma√ß√£o imediata
- RN007: Contabilizar den√∫ncias do mesmo coment√°rio (contador)

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que visualizo coment√°rio em thread
      Quando clico em menu "..."
      Ent√£o vejo op√ß√£o "Denunciar Coment√°rio"
      
- [ ] Dado que clico em "Denunciar"
      Quando modal abre
      Ent√£o vejo: preview do coment√°rio, seletor motivo, campo descri√ß√£o
      
- [ ] Dado que sou autor do coment√°rio
      Quando acesso menu
      Ent√£o op√ß√£o "Denunciar" n√£o aparece
      
- [ ] Dado que seleciono motivo e confirmo
      Quando den√∫ncia processa
      Ent√£o recebo confirma√ß√£o "Den√∫ncia enviada"
      
- [ ] Dado que mesmo coment√°rio recebe m√∫ltiplas den√∫ncias
      Quando sistema processa
      Ent√£o contador aumenta (vis√≠vel apenas para moderador)
      
- [ ] Dado que den√∫ncia √© criada
      Quando verifico BD
      Ent√£o registro cont√©m: comment_id, thread_id, reporter_id, motivo

##### Prioridade
**Alta** - Controle de qualidade

##### Complexidade
**M√©dia** - Modal com preview + valida√ß√£o

##### Depend√™ncias
RF027 (Comentar), RF129 (Fila de den√∫ncias)

##### Notas/Observa√ß√µes
- Preview coment√°rio: mostrar primeiros 200 caracteres em readonly
- Valida√ß√£o: WHERE reporter_id != comment_author_id
- Modal: similar a RF183 mas com contexto de thread
- Contador den√∫ncias: SELECT COUNT(*) FROM reports WHERE comment_id=?
- Link ao moderador: mostrar thread + coment√°rio destacado
- Considerar "Den√∫ncia r√°pida" sem descri√ß√£o obrigat√≥ria (Fase 2)



#### RF185 - Denunciar perfil/usu√°rio

##### User Story
Como **usu√°rio**
Quero **denunciar perfil ou comportamento inadequado de outro usu√°rio**
Para **alertar moderadores sobre usu√°rios problem√°ticos ou predadores**

##### Descri√ß√£o
Funcionalidade permitindo denunciar usu√°rio por comportamento inadequado (ass√©dio, spam, conte√∫do ofensivo, etc). Den√∫ncia √© dirigida ao admin com contexto sobre o problema. Suporta evid√™ncias (links para threads/coment√°rios).

##### Regras de Neg√≥cio
- RN001: Apenas usu√°rios autenticados podem denunciar
- RN002: N√£o permitir auto-den√∫ncia (valida√ß√£o)
- RN003: Motivos espec√≠ficos para usu√°rios: ass√©dio, spam, conte√∫do ofensivo, preconceito, outro
- RN004: Incluir campo para "evid√™ncias" (links a threads/coment√°rios espec√≠ficas)
- RN005: Descri√ß√£o obrigat√≥ria para den√∫ncia de usu√°rio
- RN006: Status: "pending_review" (prioridade alta)
- RN007: Armazenar: reported_user_id, reporter_id, motivo, descri√ß√£o, evidence_links

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que visualizo perfil de usu√°rio
      Quando clico em menu "..."
      Ent√£o vejo op√ß√£o "Denunciar Usu√°rio"
      
- [ ] Dado que clico em "Denunciar"
      Quando modal abre
      Ent√£o vejo: nome do usu√°rio, motivos espec√≠ficos (dropdown), campo descri√ß√£o obrigat√≥rio
      
- [ ] Dado que seleciono "Ass√©dio"
      Quando descro√ßo
      Ent√£o vejo campo "Adicionar evid√™ncias" (links para coment√°rios/threads)
      
- [ ] Dado que adiciono link de evid√™ncia
      Quando valido
      Ent√£o sistema valida se link √© v√°lido (existe no BD)
      
- [ ] Dado que confirmo den√∫ncia
      Quando processa
      Ent√£o den√∫ncia √© armazenada com status "pending_review"
      
- [ ] Dado que sou o usu√°rio sendo denunciado
      Quando acesso meu perfil
      Ent√£o n√£o vejo nada (den√∫ncia √© an√¥nima e confidencial)

##### Prioridade
**Alta** - Seguran√ßa da comunidade

##### Complexidade
**Alta** - Valida√ß√£o de evid√™ncias + sensibilidade

##### Depend√™ncias
RF001 (Cadastro de usu√°rios), RF129 (Fila den√∫ncias)

##### Notas/Observa√ß√µes
- Tabela `reports`: type='user', reported_user_id, evidence_links (JSON array)
- Evidence validation: verificar se coment√°rio_id/thread_id existe e √© do usu√°rio denunciado
- Motivos usu√°rio: "harassment", "spam", "offensive_content", "hate_speech", "other"
- Descri√ß√£o: m√≠nimo 20 caracteres (evitar den√∫ncias vazias)
- Evidence links: permite m√∫ltiplos links (array)
- Processamento: enviar para admin com HIGH priority
- Considerar "Den√∫ncia de ass√©dio sexual" com tratamento especial (LGPD)



#### RF186 - Selecionar motivo da den√∫ncia (lista predefinida)

##### User Story
Como **usu√°rio que denuncia conte√∫do**
Quero **escolher o motivo espec√≠fico da den√∫ncia de uma lista predefinida**
Para **categorizar claramente o problema e ajudar moderadores**

##### Descri√ß√£o
Dropdown/lista com motivos pr√©-categorizados para den√∫ncias. Motivos variam por tipo (thread/coment√°rio/usu√°rio). Sele√ß√£o √© obrigat√≥ria. Permite "Outro" com descri√ß√£o adicional.

##### Regras de Neg√≥cio
- RN001: Motivos para thread/coment√°rio: Spam, Conte√∫do inadequado, Viola√ß√£o diretrizes, Preconceito/√ìdio, Enganoso, Outro
- RN002: Motivos para usu√°rio: Ass√©dio, Spam, Conte√∫do ofensivo, Preconceito/√ìdio, Suspeita predador, Outro
- RN003: Sele√ß√£o obrigat√≥ria (campo required)
- RN004: Se "Outro" selecionado: campo de texto livre adicional (m√°x 200 chars)
- RN005: Motivos pr√©-traduzidos se multi-idioma (Fase 2)
- RN006: N√£o permitir envio sem motivo selecionado

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que abro modal de den√∫ncia
      Quando visualizo
      Ent√£o vejo dropdown com motivos pr√©-definidos
      
- [ ] Dado que motivos exibidos (para thread)
      Quando visualizo
      Ent√£o vejo: "Spam", "Conte√∫do inadequado", "Viola√ß√£o diretrizes", "Preconceito/√ìdio", "Enganoso", "Outro"
      
- [ ] Dado que seleciono "Spam"
      Quando confirmo
      Ent√£o motivo √© registrado com reason_code='spam'
      
- [ ] Dado que seleciono "Outro"
      Quando confirma√ß√£o
      Ent√£o campo de texto adicional aparece (descri√ß√£o do motivo)
      
- [ ] Dado que deixo motivo em branco
      Quando tento enviar
      Ent√£o bot√£o est√° desabilitado ou erro aparece "Selecione um motivo"
      
- [ ] Dado que confirmo den√∫ncia
      Quando BD registra
      Ent√£o reason_code √© armazenado para analytics

##### Prioridade
**Alta** - Categoriza√ß√£o essencial

##### Complexidade
**Baixa** - Valida√ß√£o de dropdown

##### Depend√™ncias
RF183-RF185 (Den√∫ncias)

##### Notas/Observa√ß√µes
- Lista motivos por tipo (thread/comment/user) em enum
- Dropdown com √≠cones (opcional) para cada motivo
- Help text: tooltip explicando cada motivo
- "Outro" com textarea: min 10 chars, max 200 chars
- Analytics: contar den√∫ncias por motivo para identificar problemas comuns
- Considerar "Motivos customiz√°veis" por admin (Fase 2)



#### RF187 - Adicionar descri√ß√£o opcional √† den√∫ncia

##### User Story
Como **usu√°rio que denuncia**
Quero **adicionar uma descri√ß√£o detalhada √† den√∫ncia (opcional)**
Para **fornecer contexto adicional que ajude moderadores a entender o problema**

##### Descri√ß√£o
Campo de texto livre permitindo usu√°rio adicionar contexto/detalhes al√©m do motivo pr√©-definido. Campo √© opcional mas recomendado para den√∫ncias complexas. Suporta formata√ß√£o b√°sica (quebras de linha).

##### Regras de Neg√≥cio
- RN001: Campo totalmente opcional (pode enviar s√≥ com motivo)
- RN002: M√°ximo 1000 caracteres
- RN003: Suporta quebras de linha (enter)
- RN004: Sem HTML/markdown (apenas texto puro)
- RN005: Caracteres especiais permitidos
- RN006: Campo placeholder: "Descreva o problema em detalhes (opcional)"
- RN007: Contador de caracteres vis√≠vel (ex: "250/1000")

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que abro modal de den√∫ncia
      Quando visualizo
      Ent√£o vejo campo textarea "Descri√ß√£o (opcional)"
      
- [ ] Dado que digito descri√ß√£o detalhada
      Quando texto aparece
      Ent√£o contador mostra "150/1000" (em tempo real)
      
- [ ] Dado que tento digitar 1100 caracteres
      Quando atingo 1000
      Ent√£o campo n√£o permite mais input (soft limit)
      
- [ ] Dado que pressionei Enter
      Quando linha quebra
      Ent√£o quebra de linha √© preservada (no BD e exibi√ß√£o)
      
- [ ] Dado que deixo descri√ß√£o vazia
      Quando confirmo den√∫ncia
      Ent√£o den√∫ncia √© enviada normalmente (campo opcional)
      
- [ ] Dado que descri√ß√£o √© enviada
      Quando moderador visualiza
      Ent√£o texto aparece formatado com quebras de linha

##### Prioridade
**M√©dia** - Contexto √∫til

##### Complexidade
**Baixa** - Textarea com valida√ß√£o

##### Depend√™ncias
RF183-RF185 (Den√∫ncias)

##### Notas/Observa√ß√µes
- Campo textarea com placeholder claro
- Contador de caracteres abaixo: "XXX/1000"
- Valida√ß√£o: strip HTML tags (sanitize input)
- Armazenamento: description varchar(1000) NULL
- Display: manter quebras de linha como \n
- Autocomplete desabilitado (sensitive field)
- Considerar "Anexar screenshot" (Fase 2)



#### RF188 - Confirma√ß√£o de envio de den√∫ncia

##### User Story
Como **usu√°rio que enviou den√∫ncia**
Quero **receber confirma√ß√£o visual de que minha den√∫ncia foi enviada com sucesso**
Para **ter certeza que meu relato chegou aos moderadores**

##### Descri√ß√£o
Modal ou toast de confirma√ß√£o exibindo ap√≥s envio de den√∫ncia com mensagem clara, possibilidade de enviar nova den√∫ncia ou voltar ao conte√∫do. Inclui n√∫mero de den√∫ncia para refer√™ncia (opcional).

##### Regras de Neg√≥cio
- RN001: Confirma√ß√£o exibida imediatamente ap√≥s sucesso
- RN002: Mensagem: "Obrigado! Sua den√∫ncia foi recebida e ser√° analisada"
- RN003: Op√ß√µes: "Voltar ao conte√∫do" ou "Fazer outra den√∫ncia"
- RN004: Gerar e exibir ID de den√∫ncia (para refer√™ncia)
- RN005: Dura√ß√£o da confirma√ß√£o: 5 segundos (ou clique para fechar)
- RN006: Email de confirma√ß√£o (opcional, se user habilitou)

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que confirmo envio de den√∫ncia
      Quando requisi√ß√£o processa com sucesso
      Ent√£o modal/toast aparece: "Obrigado! Sua den√∫ncia foi recebida"
      
- [ ] Dado que confirma√ß√£o √© exibida
      Quando visualizo
      Ent√£o vejo n√∫mero de den√∫ncia (ex: "Report #12345")
      
- [ ] Dado que clico em "Voltar ao Conte√∫do"
      Quando a√ß√£o executa
      Ent√£o redirecionado para thread/coment√°rio/perfil original
      
- [ ] Dado que clico em "Fazer Outra Den√∫ncia"
      Quando a√ß√£o executa
      Ent√£o volto para listagem (poder denunciar outra thread)
      
- [ ] Dado que confirma√ß√£o fica 5 segundos vis√≠vel
      Quando tempo expira
      Ent√£o modal fecha automaticamente
      
- [ ] Dado que den√∫ncia √© recebida
      Quando user habilitou email
      Ent√£o recebe email: "Recebemos sua den√∫ncia #12345"

##### Prioridade
**M√©dia** - Experi√™ncia do usu√°rio

##### Complexidade
**Baixa** - Modal/toast de confirma√ß√£o

##### Depend√™ncias
RF183-RF185 (Den√∫ncias)

##### Notas/Observa√ß√µes
- Toast type: "success" com √≠cone ‚úì
- Modal com bot√µes: "Voltar ao conte√∫do" (primary), "Fazer outra den√∫ncia" (secondary)
- Report ID: auto-incremento ou UUID
- Email template: incluir n√∫mero den√∫ncia + link para acompanhar (se fase 2)
- Close button (X): permite fechar imediatamente
- Delay antes de fechar: 5s ou clique
- Considerar "Bot√£o compartilhar ID" (Fase 2) para refer√™ncia com moderador



#### RF189 - Prevenir m√∫ltiplas den√∫ncias do mesmo conte√∫do pelo mesmo usu√°rio

##### User Story
Como **sistema**
Quero **prevenir que um usu√°rio denuncie o mesmo conte√∫do m√∫ltiplas vezes**
Para **evitar spam de den√∫ncias e manter banco de dados limpo**

##### Descri√ß√£o
Valida√ß√£o que impede user de enviar mais de uma den√∫ncia para o mesmo conte√∫do. Se user j√° denunciou, alerta √© exibido ("Voc√™ j√° denunciou este conte√∫do") e a√ß√£o √© bloqueada.

##### Regras de Neg√≥cio
- RN001: Validar: SELECT * FROM reports WHERE reporter_id=? AND reported_id=? AND reported_type=?
- RN002: Se den√∫ncia existente com status "pending" ou "approved": bloquear
- RN003: Se den√∫ncia foi "rejected": permitir nova (ap√≥s revis√£o)
- RN004: Se den√∫ncia foi "resolved": permitir nova (conte√∫do voltou ao problema?)
- RN005: Mensagem de alerta: "Voc√™ j√° denunciou este conte√∫do. Status: [pending/approved/rejected]"
- RN006: Bot√£o "Denunciar" fica desabilitado com tooltip explicativo

##### Crit√©rios de Aceita√ß√£o
- [ ] Dado que denunciei thread X
      Quando acesso thread X novamente
      Ent√£o bot√£o "Denunciar" fica desabilitado com tooltip
      
- [ ] Dado que clico no bot√£o desabilitado
      Quando visualizo tooltip
      Ent√£o vejo: "Voc√™ j√° denunciou este conte√∫do"
      
- [ ] Dado que den√∫ncia anterior foi rejeitada
      Quando visualizo thread
      Ent√£o bot√£o "Denunciar" fica habilitado (posso denunciar novamente)
      
- [ ] Dado que den√∫ncia anterior tem status "pending"
      Quando verifico BD
      Ent√£o query bloquearia nova den√∫ncia: COUNT > 0
      
- [ ] Dado que try enviar den√∫ncia duplicada via API
      Quando valida√ß√£o processa
      Ent√£o erro 409: "Voc√™ j√° denunciou este conte√∫do"
      
- [ ] Dado que deixa thread por dias
      Quando volta ap√≥s conte√∫do ser "re-violado"
      Ent√£o pode denunciar novamente (se status permitir)

##### Prioridade
**M√©dia** - Integridade de den√∫ncias

##### Complexidade
**M√©dia** - Valida√ß√£o com m√∫ltiplos estados

##### Depend√™ncias
RF183-RF185 (Den√∫ncias), RF129 (Fila den√∫ncias)

##### Notas/Observa√ß√µes
- Tabela `reports`: reported_type, reported_id, reporter_id, status (pending/approved/rejected/resolved)
- Query valida√ß√£o: WHERE reporter_id=? AND reported_id=? AND reported_type=? AND status IN ('pending', 'approved')
- Frontend: desabilitar bot√£o se existe den√∫ncia com status bloqueador
- Backend: validar mesmo assim (seguran√ßa)
- Tooltip: mostrar status da den√∫ncia anterior (pending=em an√°lise, etc)
- Email notifica√ß√£o: "Voc√™ j√° denunciou este conte√∫do em [data]. Status: [status]"
- Estados que bloqueiam: pending, approved
- Estados que permitem nova: rejected (revogada), resolved (resolvida)
- Considerar "Atualizar den√∫ncia" ao inv√©s de bloquear (Fase 2)